webpackJsonp([3],{127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app",components:{},data:function(){return{model:{name:null,password:null},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{login:function(){this.$refs.form.validate(function(e){if(!e)return!1;localStorage.setItem("j-sessionid",Math.random()),location.href="index.html"})}},mounted:function(){localStorage.clear()}}},131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(80),a=n.n(o),i=n(17),s=(n.n(i),n(8)),u=n.n(s);r.default.use(u.a),r.default.config.productionTip=!1,n(77),new r.default({el:"#app",template:"<App/>",components:{App:a.a},filters:{}})},17:function(e,t){},18:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return c});var r,o,a=!1;a=!0,o="http://amusement.com";var i=a;r=o+"/api";var s={song:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["list","detail","del","add","edit"],n={};return t.forEach(function(t){n[t]=e+"/"+t}),n}(r+"/song")},u={appid:"xxx",appsecret:"xxx"},c={19:"没有权限"}},190:function(e,t){},191:function(e,t){},192:function(e,t){},202:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-card",{staticClass:"login"},[n("div",{staticClass:"clearfix",slot:"header"},[n("div",{staticClass:"login__title"},[e._v("登录")])]),e._v(" "),n("el-form",{ref:"form",attrs:{model:e.model,rules:e.rules,"label-position":"right","label-width":"80px"}},[n("el-form-item",{attrs:{label:"用户名",prop:"name"}},[n("el-input",{model:{value:e.model.name,callback:function(t){e.model.name=t},expression:"model.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password"},model:{value:e.model.password,callback:function(t){e.model.password=t},expression:"model.password"}})],1)],1),e._v(" "),n("div",{staticClass:"login__btn-wrap"},[n("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)],1)],1)},staticRenderFns:[]}},26:function(e,t,n){"use strict";var r=n(20),o=n.n(r),a=n(1),i=n(76),s=n(29);a.default.use(i.a),t.a=new i.a({routes:[].concat(o()(s.a),[{path:"*",redirect:"/"}])})},29:function(e,t,n){"use strict";var r=n(20),o=n.n(r),a={system:"system",music:"music"},i=[{path:"/",component:function(e){s(e,"dashboard",!1)}}].concat(o()(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["list","update","view"];if(!Array.isArray(n))throw"type should be array";return n.map(function(n){var r="/"+a[t]+"/"+e+"/"+("list"===n?"list":n+"/:id"),o=n;return"view"===n&&(o="update"),{path:r,component:function(n){s(n,a[t]+"/"+e+"/"+o)}}})}("song","music"))),s=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.e(0).then(function(o){e(n(85)("./"+t+(r?"/Index":"")+".vue"))}.bind(null,n)).catch(n.oe)};t.a=i},77:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=n.n(r),a=n(81),i=n.n(a),s=n(45),u=n.n(s),c=n(8),l=(n.n(c),n(18)),d=n(26);u.a.interceptors.request.use(function(e){return new i.a(function(t,n){var r=localStorage.getItem("sc-sessionid");if(-1===e.url.indexOf(l.a.getUserInfoByCode))return"get"===e.method?(e.params=e.params||{},e.params.sessionid=r):(e.data=e.data||{},e.data.sessionid=r),t(e);p(function(n){return e.headers.Authorization="token "+n,e.headers["Content-Type"]="application/json",t(e)})})},function(e){return i.a.reject(e)}),u.a.interceptors.response.use(function(e){var t=e.data,r=e.config,o=t.errcode;if(13==o)d.a.push("/login");else if(void 0!=o&&0!=o&&!r.notShowError){var a=l.b[o]||t.errmsg;n.i(c.Message)({showClose:!0,message:a,type:"error"})}return e},function(e){return i.a.reject(e)});var p=function(e){var t=(new Date).getTime(),n=localStorage.getItem("authInfo");if(n&&(n=JSON.parse(n),(!n.expireTime||t>n.expireTime)&&(n=!1)),n)e(n.token);else{var r={app_id:l.c.appid,app_secret:l.c.appsecret};u.a.post(l.c.url,r,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(n){var r=n.data,a={token:r.token,time:(new Date).getTime(),expireTime:t+1e3*(r.expire-100)};localStorage.setItem("authInfo",o()(a)),e(r.token)},function(e){console.error("error occur when getToken "+e)})}}},80:function(e,t,n){function r(e){n(192),n(191),n(190)}var o=n(14)(n(127),n(202),r,null,null);e.exports=o.exports}},[131]);
//# sourceMappingURL=login.00ca8897d1b5161becb6.js.map